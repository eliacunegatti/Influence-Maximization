from tkinter import Label
import matplotlib.pyplot as plt
import pandas as pd
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
from matplotlib import animation
import sys
sys.path.insert(0, '')
from src.load import read_graph
'''
This file takes as input a .csv file generated by the graph_influence.py 
script and produces a plot in three dimensions showing the relationship/correlation between the three objective functions.

'''
from math import atan2,degrees
def GetAngleOfLineBetweenTwoPoints(p1, p2):
    xDiff = p2[0] - p1[0]
    yDiff = p2[1] - p1[1]
    return degrees(atan2(yDiff, xDiff))



if __name__ == '__main__':
    
    filename = "experiments/facebook_combined_8-WC/run-2.csv"

    df = pd.read_csv(filename, sep=",")


    x=  df["n_nodes"].to_list()
    z = df["influence"]
    
    z, x = zip(*sorted(zip(z, x)))
    P = [z[0], x[0]]
    Q = [z[len(z)-1], x[len(x)-1]]
    #print(P,Q)
    print(GetAngleOfLineBetweenTwoPoints(P,Q), len(x))
    
    
    filename = "experiments/facebook_combined_4-WC/run-4.csv"

    df = pd.read_csv(filename, sep=",")

    x0= df["n_nodes"].to_list()
    z0 = df["influence"].to_list()

    z0, x0 = zip(*sorted(zip(z0, x0)))
    P = [z0[0], x0[0]]
    Q = [z0[len(z0)-1], x0[len(x0)-1]]

    #print(P,Q)
    print(GetAngleOfLineBetweenTwoPoints(P,Q), len(x0))
    filename = "experiments/facebook_combined_2-WC/run-2.csv"


    df = pd.read_csv(filename, sep=",")

    x1= df["n_nodes"]
    z1 = df["influence"]


    z1, x1 = zip(*sorted(zip(z1, x1)))
    P = [z1[0], x1[0]]
    Q = [z1[len(z1)-1], x1[len(x1)-1]]
    #print(P,Q)
    print(GetAngleOfLineBetweenTwoPoints(P,Q),len(x1))



    filename = "experiments/facebook_combined-WC/run-1.csv"
   

    df = pd.read_csv(filename, sep=",")

    x2= df["n_nodes"].to_list()
    z2 = df["influence"].to_list()

    z2, x2 = zip(*sorted(zip(z2, x2)))
    P = [z2[0], x2[0]]
    Q = [z2[len(z2)-1], x2[len(x2)-1]]
    #print(P,Q)

    print(GetAngleOfLineBetweenTwoPoints(P,Q), len(x2))


    plt.scatter(z2,x2,color="red",label='Original')
    plt.scatter(z1,x1,color="orange",label='2')
    plt.scatter(z0,x0,color="blue",label='4')
    plt.scatter(z,x,color="green",label='8')

    #plt.title('Facebook PolitLTians WC p=0.01 model')
    plt.xlabel('% Influenced Nodes')
    plt.ylabel('% Nodes as seed set')
    plt.legend()
    #plt.xlim(0,100)
    plt.ylim(0,2.5)
    plt.legend()
    plt.show()
    exit(0)
    fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(10,6))

    ax1.scatter(z2,x2,color="red")
    ax1.scatter(z1,x1,color="orange")
    ax1.scatter(z0,x0,color="blue")
    ax1.scatter(z,x,color="green")

    #ax1.title('Facebook PolitWCians WC p=0.01 model')
    ax1.set_xlabel('% Influenced Nodes')
    ax1.set_ylabel('% Nodes as seed set')
    #ax1.legend()
    #Ã¥ax1.set_xlim(0,100)
    ax1.set_ylim(0,2.5)

    #ax1.savefig('aa')
    #ax1.show()
    #ax1.cla()



    ax2.scatter(y2,x2,color="red")
    ax2.scatter(y1,x1,color="orange")
    ax2.scatter(y0,x0,color="blue",)
    ax2.scatter(y,x,color="green")

    #ax2.title('Facebook PolitWCians WC model')
    ax2.set_xlabel('Communities')
    ax2.set_ylabel('% Nodes as seed set')
    ax1.set_ylim(0,2.5)
    #ax2.set_xlim(1,max(y2))
    #ax2.legend()
    #ax2.show()
    #ax2.savefig('aa_a')

    #plt.cla()

    ax3.scatter(z2,y2,color="red",label="Original")
    ax3.scatter(z1,y1,color="orange",label="1/2")
    ax3.scatter(z0,y0,color="blue", label="1/4")

    ax3.scatter(z,y,color="green",label="1/8")

    #ax3.title('Facebook PolitWCians WC model')
    ax3.set_xlabel('% Influenced Nodes')
    ax3.set_ylabel('Communities')
    #ax3.legend()
    #ax3.set_xlim(0,100)
    #ax3.savefig('aa_aa')
    #plt.legend(loc='center left')

    fig.legend(loc=7)
    fig.tight_layout()
    fig.subplots_adjust(right=0.85)  
    plt.savefig('ok_2')
    plt.show()
    #plt.cla()

    fig = plt.figure()
    ax = fig.add_subplot(projection='3d')
    ax.scatter(z, y, x, marker='o', color="green")
    ax.scatter(z0, y0, x0, marker='o', color="blue")
    ax.scatter(z1, y1, x1, marker='o', color="orange")
    ax.scatter(z2, y2, x2, marker='o', color="red")
    plt.savefig('aaa')
    plt.show()

    # fig, ax = plt.subplots(subplot_kw={"projection": "3d"})


    # from matplotlib import cm
    # fig = plt.figure()
    # ax = Axes3D(fig)
    # ax.plot_trisurf(x, y, z, color="green",linewidth=0.1,shade=True)
    # ax.plot_trisurf(x0, y0, z0, color="blue",linewidth=0.1,shade=True)
    # ax.plot_trisurf(x2, y2, z2, color="red",linewidth=0.1,shade=True)

    # plt.show()





    print(time2, time1, time0, time)

    ## Time
    fig = plt.figure(1, figsize=(9, 6))

    ax = fig.add_subplot(111)

    data_plot = [t,t0,t1,t2]

    bp = ax.boxplot(data_plot)
    plt.xtWCks([1, 2, 3, 4], ['25%', '1/4','1/8', 'Original Graph'])
    fig.suptitle('Time LT SBM')
    plt.show()
    plt.cla()
    plt.close()


    